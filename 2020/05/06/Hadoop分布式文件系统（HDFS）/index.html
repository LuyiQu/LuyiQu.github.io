<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="分布式模型与编程,">





  <link rel="alternate" href="/atom.xml" title="瞿璐祎的博客" type="application/atom+xml">






<meta name="description" content="一、 设计考量 1. HDFS设计假设、目标     a. 硬件失效         i. 硬件的异常比软件的异常更加常见     b. 流式数据访问         i. Dataflow         ii. hdfs是量身定制，并非以通用业务为目的         iii. 关注吞吐量，并非响应时间      c. 存储数据较大      d. 简化的数据一致性模型         i.">
<meta name="keywords" content="分布式模型与编程">
<meta property="og:type" content="article">
<meta property="og:title" content="Hadoop分布式文件系统（HDFS）">
<meta property="og:url" content="https://luyiqu.github.io/2020/05/06/Hadoop分布式文件系统（HDFS）/index.html">
<meta property="og:site_name" content="瞿璐祎的博客">
<meta property="og:description" content="一、 设计考量 1. HDFS设计假设、目标     a. 硬件失效         i. 硬件的异常比软件的异常更加常见     b. 流式数据访问         i. Dataflow         ii. hdfs是量身定制，并非以通用业务为目的         iii. 关注吞吐量，并非响应时间      c. 存储数据较大      d. 简化的数据一致性模型         i.">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-05-06T04:11:12.504Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hadoop分布式文件系统（HDFS）">
<meta name="twitter:description" content="一、 设计考量 1. HDFS设计假设、目标     a. 硬件失效         i. 硬件的异常比软件的异常更加常见     b. 流式数据访问         i. Dataflow         ii. hdfs是量身定制，并非以通用业务为目的         iii. 关注吞吐量，并非响应时间      c. 存储数据较大      d. 简化的数据一致性模型         i.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://luyiqu.github.io/2020/05/06/Hadoop分布式文件系统（HDFS）/">





  <title>Hadoop分布式文件系统（HDFS） | 瞿璐祎的博客</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">瞿璐祎的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">try something new</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>
            
            Schedule
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-categories" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luyiqu.github.io/2020/05/06/Hadoop分布式文件系统（HDFS）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="luyiqu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="瞿璐祎的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Hadoop分布式文件系统（HDFS）</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-06T12:10:31Z">
                2020-05-06
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/分布式模型与编程/" itemprop="url" rel="index">
                    <span itemprop="name">分布式模型与编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>一、 设计考量</p>
<pre><code>1. HDFS设计假设、目标
    a. 硬件失效
        i. 硬件的异常比软件的异常更加常见
    b. 流式数据访问
        i. Dataflow
        ii. hdfs是量身定制，并非以通用业务为目的
        iii. 关注吞吐量，并非响应时间

    c. 存储数据较大

    d. 简化的数据一致性模型
        i. 数据写入之后，不允许再修改了，只允许在后面追加

    e. 多硬件平台支持
        i. 易于运行不同的平台上（故用java编写）

    f. 移动计算能力比移动数据更划算
        i. 计算和存储采用就近原则，计算离数据最近
            1) 移动计算就是移动代码，对远程的数据进行计算

2. 如何应对大文件
    a. 文件由数据块集合组成
        i. 通常每块大小为64MB
        ii. 与os的块的区别：
            1) os的目的：省io的时间、不满还是会占整个block的大小的
            2) hdfs目的：把大的文件切小、不满是不会占64mb的

3. 索引文件
    a. 跨机器索引
</code></pre><p>二、 HDFS 架构</p>
<pre><code>1. HDFS节点类型
    a. NameNode      每个集群一个名字节点（master）
        i. 负责文件系统元数据操作、数据块的复制和定位
    b. SecondaryNamenode       NameNode的备份
    c. Datanode

2. NameNode ：
    a. 作用：管理节点、接收用户的操作请求
    b. 核心数据文件包括：
        i. 元数据镜像文件fsimage: 维护文件系统树以及文件树中所有的文件/目录的元数据
        ii. 操作日志文件EditLog: 记录所有针对文件的创建、删除、重命名等操作。
            1) 如果元数据镜像文件可以承受恢复的代价，那么日志也可以不需要了，日志为了减轻元数据镜像文件的负担。
    c. 元数据保存在内存中
    d. 做了block和datanode之间的映射关系

3. SecondaryNameNode
    a. 执行过程：
        i. 定期从Namenode上下载fsimage,edits，二者合并，生成新的fsimage
        ii. 在本地保存，并写回NameNode
    b. 它是“检查点”，而不是“热备份”（即并非实时备份）


4. DataNode
    a. 作用：一共文件的存储
    b. 文件块：一个Linux文件
    c. HDFS中，如果一个文件小于一个数据块的大小，并不占用整个数据块存储空间
    d. 数据备份：默认是三个
    e. 文件内容保存在磁盘
</code></pre><p>三、 文件访问</p>
<pre><code>1. 文件写入HDFS 
    a. NameNode 告知客户端文件的每一个数据块存储在何处
    b. 客户端将数据块直接传输到指定的数据节点

2. 数据访问

3. 从HDFS读取文件
    a. 从NameNode 返回每个数据块的位置给客户端
    b. 从数据节点上传数据块（不同的数据块可以并行读取）

4. 数据读取策略

5. 文件访问模型
    a. “一次写入多次读取”
        i. 修改内容需删除，重新写入
        ii. 仅允许追加append()   
            1) 注： 此为追加一个block，而不是在原来的block追加内容
    b. 好处：避免读写冲突，无需文件锁

6. HDFS数据备份
</code></pre><p>四、 备份与一致性</p>
<pre><code>1. 一个文件有若干备份
2. 备份之间是否可能不一致？
    a. Q：同时append两个备份
</code></pre><p>五、容错机制</p>
<pre><code>1. HDFS在设计时就考虑到故障（硬件和软件）会经常出现

2. DataNode故障：
    a. “宕机”：节点上面的所有数据都会被标记为“不可读”
    b. 定期检查备份因子

3. NameNode故障
    a. 根据SecondaryNameNode中的Fslmage和Editlog数据进行恢复

4. 其他故障
    a. 磁盘错误或故障：数据校验
    b. 交换机/机架故障
    c. 数据中心故障
</code></pre><p>六、 HDFS功能</p>
<pre><code>1. 适用：
    a. 大文件存储、流式数据访问
2. 不合适:
    a. 大量小文件（无法完美利用数据并行读取）
    b. 随机读取（因为有固定的代价）
    c. 低延迟读取
</code></pre>
      
    </div>
    
    
    
<div>
      
        
      
</div>
    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:</strong>
    luyiqu
  </li>
  <li class="post-copyright-link">
    <strong>Post link:</strong>
    <a href="https://luyiqu.github.io/2020/05/06/Hadoop分布式文件系统（HDFS）/" title="Hadoop分布式文件系统（HDFS）">https://luyiqu.github.io/2020/05/06/Hadoop分布式文件系统（HDFS）/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice: </strong>
    All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> unless stating additionally.
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/分布式模型与编程/" rel="tag"># 分布式模型与编程</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/05/06/序列化与压缩/" rel="next" title="序列化与压缩">
                <i class="fa fa-chevron-left"></i> 序列化与压缩
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="luyiqu">
            
              <p class="site-author-name" itemprop="name">luyiqu</p>
              <p class="site-description motion-element" itemprop="description">blog</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">luyiqu</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
