<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="瞿璐祎的博客" type="application/atom+xml">






<meta name="description" content="blog">
<meta name="keywords" content="个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="瞿璐祎的博客">
<meta property="og:url" content="https://luyiqu.github.io/index.html">
<meta property="og:site_name" content="瞿璐祎的博客">
<meta property="og:description" content="blog">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="瞿璐祎的博客">
<meta name="twitter:description" content="blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://luyiqu.github.io/">





  <title>瞿璐祎的博客</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">瞿璐祎的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">try something new</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>
            
            Schedule
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-categories" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luyiqu.github.io/2020/05/06/Hadoop分布式文件系统（HDFS）/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="luyiqu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="瞿璐祎的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/06/Hadoop分布式文件系统（HDFS）/" itemprop="url">Hadoop分布式文件系统（HDFS）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-06T12:10:31Z">
                2020-05-06
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/分布式模型与编程/" itemprop="url" rel="index">
                    <span itemprop="name">分布式模型与编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一、 设计考量</p>
<pre><code>1. HDFS设计假设、目标
    a. 硬件失效
        i. 硬件的异常比软件的异常更加常见
    b. 流式数据访问
        i. Dataflow
        ii. hdfs是量身定制，并非以通用业务为目的
        iii. 关注吞吐量，并非响应时间

    c. 存储数据较大

    d. 简化的数据一致性模型
        i. 数据写入之后，不允许再修改了，只允许在后面追加

    e. 多硬件平台支持
        i. 易于运行不同的平台上（故用java编写）

    f. 移动计算能力比移动数据更划算
        i. 计算和存储采用就近原则，计算离数据最近
            1) 移动计算就是移动代码，对远程的数据进行计算

2. 如何应对大文件
    a. 文件由数据块集合组成
        i. 通常每块大小为64MB
        ii. 与os的块的区别：
            1) os的目的：省io的时间、不满还是会占整个block的大小的
            2) hdfs目的：把大的文件切小、不满是不会占64mb的

3. 索引文件
    a. 跨机器索引
</code></pre><p>二、 HDFS 架构</p>
<pre><code>1. HDFS节点类型
    a. NameNode      每个集群一个名字节点（master）
        i. 负责文件系统元数据操作、数据块的复制和定位
    b. SecondaryNamenode       NameNode的备份
    c. Datanode

2. NameNode ：
    a. 作用：管理节点、接收用户的操作请求
    b. 核心数据文件包括：
        i. 元数据镜像文件fsimage: 维护文件系统树以及文件树中所有的文件/目录的元数据
        ii. 操作日志文件EditLog: 记录所有针对文件的创建、删除、重命名等操作。
            1) 如果元数据镜像文件可以承受恢复的代价，那么日志也可以不需要了，日志为了减轻元数据镜像文件的负担。
    c. 元数据保存在内存中
    d. 做了block和datanode之间的映射关系

3. SecondaryNameNode
    a. 执行过程：
        i. 定期从Namenode上下载fsimage,edits，二者合并，生成新的fsimage
        ii. 在本地保存，并写回NameNode
    b. 它是“检查点”，而不是“热备份”（即并非实时备份）


4. DataNode
    a. 作用：一共文件的存储
    b. 文件块：一个Linux文件
    c. HDFS中，如果一个文件小于一个数据块的大小，并不占用整个数据块存储空间
    d. 数据备份：默认是三个
    e. 文件内容保存在磁盘
</code></pre><p>三、 文件访问</p>
<pre><code>1. 文件写入HDFS 
    a. NameNode 告知客户端文件的每一个数据块存储在何处
    b. 客户端将数据块直接传输到指定的数据节点

2. 数据访问

3. 从HDFS读取文件
    a. 从NameNode 返回每个数据块的位置给客户端
    b. 从数据节点上传数据块（不同的数据块可以并行读取）

4. 数据读取策略

5. 文件访问模型
    a. “一次写入多次读取”
        i. 修改内容需删除，重新写入
        ii. 仅允许追加append()   
            1) 注： 此为追加一个block，而不是在原来的block追加内容
    b. 好处：避免读写冲突，无需文件锁

6. HDFS数据备份
</code></pre><p>四、 备份与一致性</p>
<pre><code>1. 一个文件有若干备份
2. 备份之间是否可能不一致？
    a. Q：同时append两个备份
</code></pre><p>五、容错机制</p>
<pre><code>1. HDFS在设计时就考虑到故障（硬件和软件）会经常出现

2. DataNode故障：
    a. “宕机”：节点上面的所有数据都会被标记为“不可读”
    b. 定期检查备份因子

3. NameNode故障
    a. 根据SecondaryNameNode中的Fslmage和Editlog数据进行恢复

4. 其他故障
    a. 磁盘错误或故障：数据校验
    b. 交换机/机架故障
    c. 数据中心故障
</code></pre><p>六、 HDFS功能</p>
<pre><code>1. 适用：
    a. 大文件存储、流式数据访问
2. 不合适:
    a. 大量小文件（无法完美利用数据并行读取）
    b. 随机读取（因为有固定的代价）
    c. 低延迟读取
</code></pre>
          
        
      
    </div>
    
    
    
<div>
      
</div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-categories" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luyiqu.github.io/2020/05/06/序列化与压缩/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="luyiqu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="瞿璐祎的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/06/序列化与压缩/" itemprop="url">序列化与压缩</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-06T12:09:14Z">
                2020-05-06
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/分布式模型与编程/" itemprop="url" rel="index">
                    <span itemprop="name">分布式模型与编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="序列化与压缩"><a href="#序列化与压缩" class="headerlink" title="序列化与压缩"></a>序列化与压缩</h2><pre><code>1. 序列化的基本概念
2. 数据压缩的原理

3. 序列化与压缩
    a. 序列化的意义：
        i. 编写程序写文件A，另一个程序读取文件A
        ii. 进程通信时传输的数据
            1) 基本数据类型实例：int，long，double等数值
            2) 用户自定义类的实例：对象
        iii. 如何完成进程间的对象传送？
            1) 
                a) C c = new C(x,x,x)；是在另外一个进程，调用class c 吗
                b) 然后class c是作为进程通信时传输的数据，进行序列化传到C c 所在的进程？

    b. 定义：
        i. 序列化：把对象状态按照一定的格式转换成有序字节流，以便在网络上传输或者保存在本地文件中 
        ii. 反序列化：从文件中或网络上获得序列化后的对象字节流后，根据字节流中所保存的对象状态及描述信息，重建对象

    c. 序列化：
        i. 数据需要序列化以后才能在服务端和客户端之间传输。
        ii. 这个服务端和客户端的概念是广义的，可以在网络上，也可以在同一台机器的不同进程中，甚至在同一个进程中进行通信。
        iii. 序列化协议：JSON、XML、Thrift、Protobuf…


    a. 压缩：通过一些有别于原始编码的特殊编码方式来保存数据，使数据占用的存储空间比较小
        i. 压缩可以减少网络传输时间，但是压缩和解压缩需要时间
    b. 解压缩：将被压缩的数据从特殊编码方式还原为原始数据的过程
        i. 解压需要时间
    c. 压缩算法的评价
        i. 时间：压缩速度、解压速度
        ii. 空间： 压缩比 = 压缩后所占空间/压缩前所占空间
        iii. 故 压缩时间要短、空间占比要小
</code></pre>
          
        
      
    </div>
    
    
    
<div>
      
</div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-categories" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luyiqu.github.io/2020/05/06/进程通信/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="luyiqu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="瞿璐祎的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/06/进程通信/" itemprop="url">进程通信</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-06T12:06:03Z">
                2020-05-06
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/分布式模型与编程/" itemprop="url" rel="index">
                    <span itemprop="name">分布式模型与编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="进程通信"><a href="#进程通信" class="headerlink" title="进程通信"></a>进程通信</h2><pre><code>1. 进程与线程的区别
    a. 线程是进程的一个实体，是CPU调度和分派的基本单位
    b. 进程在执行过程中拥有独立的内存单元，而多个线程共享内存
    c. 线程不能够独立执行，必须依赖进程

2. 进程间的通信方式
    a. 进程之间需要交换数据
    b. 进程各自有不同的用户地址空间
        i. 同一台机器
        ii. 不同机器
    c. 通过操作系统内核
    d. 方式：信号，信号量，消息队列（小的）、文件 、管道(pipe)、 有名管道（FIFO) 、 共享内存 、套接字

3. 远程过程调用RPC

4. 进程间通信方式 IPC
    a. 控制 control flow  ： 信号，信号量，消息队列（小的）
        i. 信号：
            1) 信号可以在任何时候由内核发给某一进程
        ii. 消息队列： 
            1) 两个不相关进程间。独立于发送进程、接受进程而存在。
        iii. 信号量：
            1) 进程间对共享数据的互斥访问

    b. 数据 data flow  ：文件 、管道(pipe)、 有名管道（FIFO) 、 共享内存 、套接字
        i. 管道：半双工（数据只能向一个方向流动）、只能用于父子进程或兄弟进程之间（必须在同一台机器上，两台机器上不存在）、实质是一个内核缓冲区，独立于文件系统
        ii. 匿名管道：半双工、不相关的进程也可以，有名管道的名字存在于文件系统中，内容存放在内存中
        iii. 共享内存：
            1) 内核留出了一块内存区，可以由需要访问的进程将其映射到自己的私有地址空间
            2) 需要同步机制来达到进程间的同步及互斥
        iv. 套接字：
            1) TCP/IP 的网络通信
            2) 进程间使用套接字中的相关函数来通信 
            3) 本地单机或跨网络


        注：需要端口的原因：区别服务种类，一台主机上可能存有很多数据
</code></pre>
          
        
      
    </div>
    
    
    
<div>
      
</div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-categories" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luyiqu.github.io/2020/05/06/分布式模型与编程大纲/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="luyiqu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="瞿璐祎的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/06/分布式模型与编程大纲/" itemprop="url">分布式模型与编程大纲</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-06T12:00:16Z">
                2020-05-06
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/分布式模型与编程/" itemprop="url" rel="index">
                    <span itemprop="name">分布式模型与编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="大纲"><a href="#大纲" class="headerlink" title="大纲"></a>大纲</h1><h2 id="分布式系统"><a href="#分布式系统" class="headerlink" title="分布式系统"></a>分布式系统</h2><pre><code>1. 分布式系统应用
    a. 科学计算：CPU是瓶颈
    b. 数据密集：数据IO是计算过程的瓶颈
    c. 智能家居
    d. 事务处理
    e. 传感网络：扫车牌是否能进门？
2. 纵向扩展： scalue-up （提高单台机器的处理能力）
    a. 异步通信：  成批传输数据
        i. 将check form 从服务器端转移到客户端，可以减轻服务器端的压力，进而可以提高单台机器的处理能力。
        ii. 可能双方的时钟频率不一致
3. 横向扩展：scale-out （增加机器的数量）
4. 事务处理：考虑到并发控制，假如没有事务处理，可以会读到脏数据、丢失数据修改等等
</code></pre><h2 id="大数据处理"><a href="#大数据处理" class="headerlink" title="大数据处理"></a>大数据处理</h2><pre><code>1. 大数据概念：大量化、快速化（双十一购物）、多样化、价值化
2. Web1.0 与 Web2.0的区别：
    a. 前者是只有文本、图像、视频(用户不能发帖，只能看）
    b. 后者用户可以发帖，数据量更大了。
3. 大数据由结构化（10% 在数据库中）和非结构化数据（90%）组成
</code></pre><h2 id="分布式数据处理系统"><a href="#分布式数据处理系统" class="headerlink" title="分布式数据处理系统"></a>分布式数据处理系统</h2><pre><code>1. 分布式数据管理 两大核心技术：
    a. 分布式事务管理：NoSQL/NewSQL
    b. 分布式数据处理：批处理/流计算
2. 进程通信
3. 序列化与压缩
    a. 序列化的三种途径：
        i. 一种持久化格式：一个对象序列化以后他的编码可以存储在磁盘上
        ii. 通信数据格式
    b. 序列化的作用：
        i. 把对象变成一串字节流，是持久化的一种方式（保存在磁盘上）
    c. 序列化机制：将数据转换为连续的byte数据，并且不用担心平台移植性。
    d. 两者都是为了节省空间
    e.  序列化可理解为将一个组合办公桌（对象）按标准拆解为散件，以方便运输（网络上传输），到达目的地后再重新组装成一个整体办公桌，所以序列化的目的不是压缩，而是变成  流以方便网络传输并能重新组装为对象,  后来大家又发现一张桌子有四条腿，不需要运输1111这种方式，改成1,4就可以了，这就是压缩了。

4. 支持数据管理的底层系统
    a. 元数据管理系统：Zookeeper
    b. 资源管理系统：Yarn
    c. 分布式文件系统：HDFS
5. 面向分析的分布式数据处理系统
    a. 批处理系统：MapReduce、Spark
    b. 流计算系统：Storm、Spark Streaming
    c. 批处理流计算一体化系统：Google Dataflow、Flink

6. 支持领域应用的分布式数据处理系统
    a. 图数据处理系统：Hama、GraphX、Gelly
    b. 可扩展机器学习系统：Mahout、SystemML、Parameter Server、Tensorflow
</code></pre><h2 id="分布式编程"><a href="#分布式编程" class="headerlink" title="分布式编程"></a>分布式编程</h2><pre><code>1. 经典问题：单词计算
2. 分布式并行编程：
    a. 传统并行编程：MPI:
    基于消息传递的并行程序。消息传递指的是并行运行的各个进程具有自己独立的堆栈和代码段，作为互不相关的多个程序独立运行，进程之间的信息交互全然通过显示地调用通信函数来完毕。

    b. MapReduce

3. 分布式编程模型
    a. MapReduce （实现&lt;key,value&gt;的键值对）
    b. DAG模型
    c. Dataflow模型（流计算和批处理的一体化）
    d. 流计算模型
    e. 图计算模型（顶点-边）
    f. 迭代模型
    g. 广播变量模型（Kmeans中的参数）
</code></pre>
          
        
      
    </div>
    
    
    
<div>
      
</div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-categories" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luyiqu.github.io/2020/04/27/第十三章-索引结构/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="luyiqu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="瞿璐祎的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/04/27/第十三章-索引结构/" itemprop="url">第十三章 索引结构</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-04-27T12:11:13Z">
                2020-04-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第十三章-索引结构"><a href="#第十三章-索引结构" class="headerlink" title="第十三章 索引结构"></a>第十三章 索引结构</h1><h2 id="13-1-顺序文件上的索引"><a href="#13-1-顺序文件上的索引" class="headerlink" title="13.1 顺序文件上的索引"></a>13.1 顺序文件上的索引</h2><ul>
<li>稠密索引：一个索引对应一个元组</li>
<li>稀疏索引：一个索引对应一个数据块</li>
<li>多级索引：在索引上建立索引，高级索引量少可以放于内存，减少在磁盘中查找索引的I/O开销</li>
</ul>

          
        
      
    </div>
    
    
    
<div>
      
</div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-categories" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luyiqu.github.io/2020/04/27/MongoDB-Architecture-Guide-Overview/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="luyiqu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="瞿璐祎的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/04/27/MongoDB-Architecture-Guide-Overview/" itemprop="url">MongoDB Architecture Guide: Overview</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-04-27T10:50:42Z">
                2020-04-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    
<div>
      
</div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-categories" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luyiqu.github.io/2020/04/18/Oracle AWR/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="luyiqu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="瞿璐祎的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/04/18/Oracle AWR/" itemprop="url">Oracle AWR</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-04-18T08:59:03Z">
                2020-04-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/oracle/" itemprop="url" rel="index">
                    <span itemprop="name">oracle</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Oracle-AWR"><a href="#Oracle-AWR" class="headerlink" title="Oracle AWR"></a>Oracle AWR</h2><pre><code>- 目的：想知道oracle Automatic Wordload Repository（AWR）中有哪些我们可以获取得以利用
- 关键字：snapshot(快照)、baselines（基线）、Adaptive Thresholds(自适应阀值)、Space Consumption(空间消耗)
- 启动： STATISTICS_LEVEL设为TYPICAL或ALL
- 总结：只是一个历史性能数据的库，不具备实时的功能
</code></pre><h2 id="AWR包括的统计信息"><a href="#AWR包括的统计信息" class="headerlink" title="AWR包括的统计信息"></a>AWR包括的统计信息</h2><pre><code>- 对象统计
- 时间模型统计
- 系统和会话统计
- 获取会话历史统计
</code></pre><h2 id="Snapshot"><a href="#Snapshot" class="headerlink" title="Snapshot"></a>Snapshot</h2><pre><code>- 默认oracle每个小时自动产生一次快照，并保留8天负载统计信息
- 可通过自动数据库诊断器进行分析（ADDM）
    - 定期分析AWR数据
    - 诊断性能问题的起因
    - 为纠错提供推荐
    - 定义系统中没问题的部分
- AWR比较不同快照之间的差异来确定捕获影响系统负载的SQL语句【这个有意思】
- 可以修改Snapshot设置的单个参数，Retention（保留时间，min=1，max=100 年），Interval（收集的频率 min=10分钟,max=1年）、Topnsql（指定收集的比较占用资源的SQL数量 ,min=30,max=100000000）
</code></pre><h2 id="Baselines"><a href="#Baselines" class="headerlink" title="Baselines"></a>Baselines</h2><pre><code>- 定义：专门用于比较的基准线，Baseline中包含指定时间点时的性能数据，过期也不会被清除
- 使用：
    - 检阅DBA_HIST_SNAPSHOT视图中已存在的快照 
    - 用CREATE_BASELINE过程来创建期望快照范围基线
- 类型：
    - 固定基线
    - 移动窗口基线
    - 模板基线
</code></pre><h2 id="Adaptive-Thresholds"><a href="#Adaptive-Thresholds" class="headerlink" title="Adaptive Thresholds"></a>Adaptive Thresholds</h2><pre><code>- 可以监控和检测性能问题，同时可以最大限度地减少管理开销。
</code></pre><h2 id="Space-Consumption"><a href="#Space-Consumption" class="headerlink" title="Space Consumption"></a>Space Consumption</h2><pre><code>- AWR中空间消耗由是三个因素导致：
    - 系统中活动时间的会话数
    - 快照间隔
    - 历史数据的保留期
</code></pre>
          
        
      
    </div>
    
    
    
<div>
      
</div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-categories" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luyiqu.github.io/2020/04/18/数据库系统实现 第一章/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="luyiqu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="瞿璐祎的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/04/18/数据库系统实现 第一章/" itemprop="url">数据库系统实现 第一章</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-04-17T23:26:48Z">
                2020-04-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/数据库相关书籍笔记/" itemprop="url" rel="index">
                    <span itemprop="name">数据库相关书籍笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="数据库系统实现-第一章"><a href="#数据库系统实现-第一章" class="headerlink" title="数据库系统实现 第一章"></a>数据库系统实现 第一章</h1><ul>
<li>DBMS信息类型包括：<ul>
<li>数据</li>
<li>元数据</li>
<li>日志记录：记录对数据库所做改变的信息（保证持久性）</li>
<li>统计信息：DBMS收集和存储的关于数据库中的各个关系或其它成分的大小、取值等信息</li>
<li>索引：对数据进行高效存取</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    
<div>
      
</div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-categories" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luyiqu.github.io/2018/11/12/jieba分词-tfidf文本表征-SVM分类/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="luyiqu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="瞿璐祎的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/12/jieba分词-tfidf文本表征-SVM分类/" itemprop="url">jieba分词+tfidf文本表征+SVM分类</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-12T10:24:13Z">
                2018-11-12
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/项目/" itemprop="url" rel="index">
                    <span itemprop="name">项目</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> feature_extraction</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> TfidfTransformer</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> CountVectorizer</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> precision_recall_fscore_support</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def read_data(url):</span><br><span class="line">    data = pd.read_csv(url,encoding=&apos;utf-8&apos;)</span><br><span class="line">    data.fillna(&quot;null&quot;,inplace=True)      #使用inplace参数会改掉本身 </span><br><span class="line">    return data</span><br></pre></td></tr></table></figure>
<h1 id="数据清洗"><a href="#数据清洗" class="headerlink" title="数据清洗"></a>数据清洗</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">clean_text</span><span class="params">(text)</span>:</span></span><br><span class="line">    text = str(text)</span><br><span class="line">    text = text.replace(<span class="string">'\n'</span>, <span class="string">''</span>)</span><br><span class="line">    text = text.replace(<span class="string">'&lt;br /&gt;'</span>, <span class="string">' '</span>)</span><br><span class="line">    text = text.replace(<span class="string">';'</span>, <span class="string">','</span>)</span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tokenize_df_content</span><span class="params">(data)</span>:</span></span><br><span class="line">    df_empty = pd.DataFrame()</span><br><span class="line">    <span class="keyword">return</span> df_empty.assign(content_tokens=data[<span class="string">"content"</span>].map(clean_text)).assign(title_tokens=data[<span class="string">'title'</span>].map(clean_text)).assign(label_tokens=data[<span class="string">'ann_labels'</span>].map(clean_text))</span><br><span class="line"><span class="comment">#将content&amp;title&amp;ann_labels的内容都进行过清洗，形成一个新的dataframe</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stop_words</span><span class="params">()</span>:</span></span><br><span class="line">    stop_words_file = open(<span class="string">'stopword.txt'</span>, <span class="string">'r'</span>)</span><br><span class="line">    stopwords_list = []</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> stop_words_file.readlines():</span><br><span class="line">        stopwords_list.append(line)</span><br><span class="line">    <span class="keyword">return</span> stopwords_list</span><br></pre></td></tr></table></figure>
<h1 id="对content-amp-title进行分词"><a href="#对content-amp-title进行分词" class="headerlink" title="对content&amp;title进行分词"></a>对content&amp;title进行分词</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">def jieba_data(data,i):</span><br><span class="line">    stopwords_list = stop_words()</span><br><span class="line">    data_title=jieba.cut(data[&apos;title_tokens&apos;][i])</span><br><span class="line">    data_content=jieba.cut(data[&quot;content_tokens&quot;][i])</span><br><span class="line">    data_result = &quot; &quot;</span><br><span class="line">    for title_word in data_title:</span><br><span class="line">        if(title_word not in stopwords_list):</span><br><span class="line">            data_result += title_word+&quot; &quot;</span><br><span class="line">    for content_word in data_content:</span><br><span class="line">        if(content_word not in stopwords_list):</span><br><span class="line">         data_result += content_word+&quot; &quot;</span><br><span class="line">    </span><br><span class="line">    return data_result</span><br><span class="line"></span><br><span class="line">def jieba_label(data_result,data,i):</span><br><span class="line">    stopwords_list = stop_words()</span><br><span class="line">    data_label = jieba.cut(data[&apos;label_tokens&apos;][i])</span><br><span class="line">    for label_word in data_label:</span><br><span class="line">        if(label_word not in stopwords_list):</span><br><span class="line">            data_result += label_word+&quot; &quot;</span><br><span class="line">    </span><br><span class="line">    return data_result</span><br></pre></td></tr></table></figure>
<h1 id="训练集的jieba分词"><a href="#训练集的jieba分词" class="headerlink" title="训练集的jieba分词"></a>训练集的jieba分词</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def train_jieba(data,i):</span><br><span class="line">    data_result = jieba_data(data,i);</span><br><span class="line">    result = jieba_label(data_result,data,i);</span><br><span class="line">    return result;</span><br></pre></td></tr></table></figure>
<h1 id="测试集的jieba分词"><a href="#测试集的jieba分词" class="headerlink" title="测试集的jieba分词"></a>测试集的jieba分词</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def test_jieba(data,i):</span><br><span class="line">    data = jieba_data(data,i);</span><br><span class="line">    return data;</span><br></pre></td></tr></table></figure>
<h1 id="读取数据"><a href="#读取数据" class="headerlink" title="读取数据"></a>读取数据</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    train_data_x = read_data(<span class="string">'df_news_train_ecnu.csv'</span>)</span><br><span class="line">    test_data_x = read_data(<span class="string">'df_news_test_ecnu.csv'</span>)</span><br><span class="line">    y_train = np.loadtxt(<span class="string">"y_train_ecnu.csv"</span>, delimiter=<span class="string">","</span>,encoding=<span class="string">'utf-8'</span>)  <span class="comment">#读入文件并以矩阵或向量的形式输出</span></span><br><span class="line">    y_test = np.loadtxt(<span class="string">"y_test_ecnu.csv"</span>, delimiter=<span class="string">","</span>,encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">    print(train_data_x.shape)</span><br><span class="line">    print(test_data_x.shape)</span><br></pre></td></tr></table></figure>
<pre><code>输出：(2582, 5)
    (1107, 5)
</code></pre><h1 id="获得标签值"><a href="#获得标签值" class="headerlink" title="获得标签值"></a>获得标签值</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">unimportant_idx = 44</span><br><span class="line">   train_label_y = y_train[:, unimportant_idx]</span><br><span class="line">   test_label_y = y_test[:, unimportant_idx]</span><br><span class="line">   print(&quot;# unimportant / total news in training data: &quot;, int(sum(y_train[:, unimportant_idx])), &quot;/&quot;, len(y_train[:, unimportant_idx]))</span><br></pre></td></tr></table></figure>
<h1 id="分词并保存分词结果"><a href="#分词并保存分词结果" class="headerlink" title="分词并保存分词结果"></a>分词并保存分词结果</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">train_data_clean_x = tokenize_df_content(train_data_x)</span><br><span class="line">   test_data_clean_x = tokenize_df_content(test_data_x)</span><br><span class="line">   print(train_data_x.shape)</span><br><span class="line">   print(test_data_x.shape)</span><br><span class="line">   print(train_data_clean_x.shape)</span><br><span class="line">   print(test_data_clean_x.shape)   #此时的标签是content_tokens title_tokens label_tokens</span><br><span class="line">   </span><br><span class="line">   train_x = []       #训练集的语料库</span><br><span class="line">   test_x = []        #测试集的语料库</span><br><span class="line">   for i in range(len(train_data_clean_x)):</span><br><span class="line">           train_x.append(train_jieba(train_data_clean_x,i))</span><br><span class="line">   for i in range(len(test_data_clean_x)):</span><br><span class="line">           test_x.append(test_jieba(test_data_clean_x,i))</span><br><span class="line"></span><br><span class="line">   train_x = np.array(train_x)</span><br><span class="line">   test_x = np.array(test_x)</span><br><span class="line">   np.savetxt(&quot;tmp/X_train.csv&quot;, train_x, delimiter=&quot;,&quot;,fmt = &quot;%s&quot;,encoding=&quot;utf-8&quot;)</span><br><span class="line">   np.savetxt(&quot;tmp/X_test.csv&quot;, test_x, delimiter=&quot;,&quot;,fmt = &quot;%s&quot;,encoding=&quot;utf-8&quot;)</span><br></pre></td></tr></table></figure>
<pre><code>输出：
    (2582, 5)
    (1107, 5)
    (2582, 3)
    (1107, 3)
</code></pre><h1 id="tfidf-之构造权重矩阵"><a href="#tfidf-之构造权重矩阵" class="headerlink" title="tfidf 之构造权重矩阵"></a>tfidf 之构造权重矩阵</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    vectorizer = CountVectorizer()  #只考虑词汇在文本中出现的频率</span><br><span class="line">    transformer = TfidfTransformer()  #tfidf值</span><br><span class="line">    train_tfidf=transformer.fit_transform(vectorizer.fit_transform(train_x))#将tf-idf矩阵抽取出来，元素a[i][j]表示j词在i类文本中的tf-idf权重  </span><br><span class="line">    print(train_tfidf.shape)</span><br><span class="line">    test_tfidf = transformer.transform(vectorizer.transform(test_x))  #先拟合fit，找到该part的整体指标，对于test，transform保证train、test处理方式相同。</span><br><span class="line">#     test_weight = test_tfidf.toarray()</span><br><span class="line">#     print(test_weight.shape)</span><br></pre></td></tr></table></figure>
<pre><code>输出：(2582, 72998)
</code></pre><h1 id="tfidf-之打印特征文本"><a href="#tfidf-之打印特征文本" class="headerlink" title="tfidf 之打印特征文本"></a>tfidf 之打印特征文本</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">weight = train_tfidf.toarray() </span><br><span class="line">word = vectorizer.get_feature_names()  #获取词袋模型中的所有词语 </span><br><span class="line">for i in range(5):#打印每类文本的tf-idf词语权重，第一个for遍历所有文本，第二个for便利某一类文本下的词语权重  </span><br><span class="line">    print(&quot;************************第&quot;,i,&quot;篇文章的词语tf-idf权重**********************&quot;  )</span><br><span class="line">    for j in range(len(word)):</span><br><span class="line">        if(weight[i][j] &gt;0.1):   </span><br><span class="line">            print(word[j],weight[i][j])</span><br></pre></td></tr></table></figure>
<pre><code>输出：
    ************************第 0 篇文章的词语tf-idf权重**********************
    一致性 0.30716252706000763    
    仿制 0.21851023802630334
    医疗机构 0.27535485762167283
    原研 0.2036921591200047
    ......
</code></pre><h1 id="二分类【非重要新闻】¶"><a href="#二分类【非重要新闻】¶" class="headerlink" title="二分类【非重要新闻】¶"></a>二分类【非重要新闻】¶</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">svmmodel = SVC(C = 1 , kernel= &quot;linear&quot;) #kernel：rbf, poly在这里都没有线性的好</span><br><span class="line"></span><br><span class="line">nn = svmmodel.fit(train_tfidf,train_label_y)</span><br><span class="line">print(nn)</span><br><span class="line">pre_test_label = svmmodel.predict(test_tfidf)</span><br><span class="line">test_data_x[&quot;category&quot;] = pre_test_label</span><br><span class="line">np.savetxt(&quot;tmp/test_data_label.csv&quot;, test_data_x, delimiter=&quot;,&quot;,fmt = &quot;%s&quot;,encoding=&quot;utf-8&quot;)</span><br></pre></td></tr></table></figure>
<h1 id="评判指标"><a href="#评判指标" class="headerlink" title="评判指标"></a>评判指标</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">from sklearn.metrics import classification_report</span><br><span class="line">print(classification_report(test_label_y, pre_test_label))</span><br></pre></td></tr></table></figure>
<pre><code>输出：
             precision    recall  f1-score   support

    0.0       0.76      0.92      0.83       783
    1.0       0.59      0.29      0.39       324

    avg / total       0.71      0.73      0.70      1107
</code></pre>
          
        
      
    </div>
    
    
    
<div>
      
</div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-categories" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luyiqu.github.io/2018/11/12/Spark之join操作/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="luyiqu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="瞿璐祎的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/12/Spark之join操作/" itemprop="url">Spark之join操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-11T22:28:48Z">
                2018-11-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/分布式模型与编程/" itemprop="url" rel="index">
                    <span itemprop="name">分布式模型与编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Spark之join操作-md"><a href="#Spark之join操作-md" class="headerlink" title="Spark之join操作.md"></a>Spark之join操作.md</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.SparkConf;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.api.java.JavaPairRDD;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.api.java.JavaRDD;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.api.java.JavaSparkContext;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.api.java.function.FlatMapFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.api.java.function.Function2;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.api.java.function.PairFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.api.java.function.VoidFunction;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> scala.Tuple2;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">join</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		SparkConf conf = <span class="keyword">new</span> SparkConf().setAppName(<span class="string">"join"</span>).setMaster(<span class="string">"local[*]"</span>);</span><br><span class="line">		JavaSparkContext jsc = <span class="keyword">new</span> JavaSparkContext(conf);</span><br><span class="line">		JavaRDD&lt;String&gt; persons = jsc.textFile(<span class="string">"spark/input3/person.txt"</span>);</span><br><span class="line">		JavaRDD&lt;String&gt; addresses = jsc.textFile(<span class="string">"spark/input3/address.txt"</span>);</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		<span class="comment">//得到 key: 邮编号，value:学号和名字</span></span><br><span class="line">		JavaPairRDD&lt;String, String&gt; personkv = persons.mapToPair(<span class="keyword">new</span> PairFunction&lt;String, String,String&gt;() &#123;</span><br><span class="line">			<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> Tuple2&lt;String,String&gt; <span class="title">call</span><span class="params">(String str)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">				</span><br><span class="line">					String[] personsplit = str.split(<span class="string">" |\t"</span>);     <span class="comment">// notice maybe \t</span></span><br><span class="line">					<span class="comment">//System.out.println("length"+personsplit.length);</span></span><br><span class="line">					<span class="comment">//处理缺省数据</span></span><br><span class="line">					<span class="keyword">if</span> (personsplit.length == <span class="number">3</span>)</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="comment">//System.out.println("i am not null");</span></span><br><span class="line">						String code=personsplit[<span class="number">2</span>];</span><br><span class="line">						String value = personsplit[<span class="number">0</span>] +<span class="string">" "</span>+ personsplit[<span class="number">1</span>];		<span class="comment">//number + name</span></span><br><span class="line">						<span class="keyword">return</span> <span class="keyword">new</span> Tuple2&lt;String, String&gt;(code, value);</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span> &#123;</span><br><span class="line">						</span><br><span class="line">						<span class="comment">//System.out.println("null null null ++++++++="+personsplit.length);	</span></span><br><span class="line">						<span class="keyword">return</span> <span class="keyword">new</span> Tuple2&lt;String,String&gt;(<span class="keyword">null</span>,<span class="keyword">null</span>);</span><br><span class="line">						&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);  <span class="comment">// to split the person and get the form &lt;210000,1 Aaron&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//得到key: 邮编号 value:城市</span></span><br><span class="line">		JavaPairRDD&lt;String, String&gt; addresskv = addresses.mapToPair(<span class="keyword">new</span> PairFunction&lt;String, String,String&gt;() &#123;</span><br><span class="line">			<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> Tuple2&lt;String,String&gt; <span class="title">call</span><span class="params">(String str)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">				String[] addresssplit = str.split(<span class="string">" |\t"</span>);</span><br><span class="line">				String code=addresssplit[<span class="number">0</span>];</span><br><span class="line">				String value = addresssplit[<span class="number">1</span>];		<span class="comment">//city</span></span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">new</span> Tuple2&lt;String, String&gt;(code, value);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);				<span class="comment">//to split the address and get the  form &lt;210000,Nanjing&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//进行join操作</span></span><br><span class="line">		JavaPairRDD&lt;String, Tuple2&lt;String, String&gt;&gt; joinres=personkv.join(addresskv);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//遍历输出</span></span><br><span class="line">		joinres.foreach(<span class="keyword">new</span> VoidFunction&lt;Tuple2&lt;String, Tuple2&lt;String, String&gt;&gt;&gt;() &#123;</span><br><span class="line">			<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Tuple2&lt;String, Tuple2&lt;String, String&gt;&gt; t)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">				System.out.println(t._2()._1+<span class="string">" "</span>+t._1+ <span class="string">" "</span>+t._2()._2);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;);</span><br><span class="line"></span><br><span class="line">		joinres.saveAsTextFile(<span class="string">"./spark/output3/"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="输入"><a href="#输入" class="headerlink" title="输入:"></a>输入:</h2><pre><code>person.txt:
    1 Aaron 210000
    .....
address.txt:
    210000 Nanjing
    .........
</code></pre>
          
        
      
    </div>
    
    
    
<div>
      
</div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="luyiqu">
            
              <p class="site-author-name" itemprop="name">luyiqu</p>
              <p class="site-description motion-element" itemprop="description">blog</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">luyiqu</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
